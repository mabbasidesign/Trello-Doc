# How We Implemented Identity, Key Vault, and Security in This App

## 1. Entra ID (Azure AD)
- All Azure resources (Key Vault, Cosmos DB, App Service) are protected by Entra ID.
- We use Entra ID to manage access and permissions for both users and applications.

## 2. Managed Identity
- Each App Service (or container) is assigned a **system-assigned managed identity** via Bicep or Azure Portal.
- This identity is used by the app to authenticate to Azure resources without storing secrets.
- Bicep scripts grant this identity access to Key Vault and Cosmos DB using RBAC.

## 3. RBAC vs Connection Strings
- **Local/dev:** We use connection strings in appsettings.Development.json for easy local testing (never committed to source control).
- **Production:** We use managed identity and RBAC for Cosmos DB and Key Vault access. No secrets are stored in code or config files.
- RBAC roles (e.g., "Cosmos DB Built-in Data Contributor", "Key Vault Secrets User") are assigned to the managed identity.

## 4. Key Vault Integration
- Key Vault is deployed via Bicep and stores secrets (e.g., SQL password, Cosmos DB key if needed).
- The app’s managed identity is granted access to Key Vault via RBAC.
- In App Service configuration, secrets are referenced using Key Vault references or fetched at runtime using Azure SDKs.
- Example: The SQL password or Cosmos DB key is never in code; it’s retrieved securely from Key Vault.

## 5. Secretless Authentication
- In production, the app uses `DefaultAzureCredential` (or similar) to automatically use its managed identity.
- When the app needs to access Key Vault or Cosmos DB, Azure authenticates it using its managed identity—no passwords or keys required.
- Permissions are controlled via RBAC in Entra ID.

## 6. Service-to-Service Authentication
- If one service needs to call another, it uses its managed identity to obtain a token from Entra ID and presents it to the other service.
- The receiving service validates the token and authorizes the request based on RBAC or claims.

## 7. Pipeline and Bicep Automation
- The Azure pipeline builds and deploys the app, Docker images, and infrastructure.
- Bicep templates automate the creation of all resources, assignment of managed identities, and RBAC roles.
- The pipeline injects secrets as environment variables or Key Vault references—never in code.

---

**Summary:**
- We use Entra ID, managed identity, RBAC, and Key Vault to achieve secretless, secure, cloud-native authentication and authorization.
- All sensitive operations are automated and auditable via Bicep and pipeline scripts.
- No secrets are ever stored in code or production config files.
- Local/dev uses connection strings, but never commits secrets to source control.

This approach is secure, modern, and ready for both real-world deployments and technical interviews.


